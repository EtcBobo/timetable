<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width" />
    <meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <title>Register Page</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
    <style>
        label {
            margin: 10px;
            font-size: 24px;
        }

        ul {
            margin-bottom: 10px;
        }

        ul li {
            margin: 5px 10px;
            padding: 5px;
            color: #000;
            word-wrap: break-word;
        }
    </style>



</head>

<body>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">



<div id="signup">Register Now!</div>
 <div class="container">
    <br><br>



    <form method="post" id="registerForm" class="form-group col-lg-12" enctype="multipart/form-data">
         <div class="form-group col-md-12" id="regbox">
            <div class="row">

                <div class="col-md-12">

                <img id="output" src="../image/profileTemp.png" class="img-responsive" width="100" height="100">

                </div>
              </div>
                <br>
                <br>
                <div class="row">

                        <div class="col-md-12">
                <button onclick="uploadImage()" id="upButton">Upload</button>
                </div>

                <br>
                <br>
                <br>
                </div>
                <div class="row">
                <div class="form-group col-md-12">
                    Username:<br>
                <input type="text" name="username" id="username" class="form-control">
                </div>
                </div>
                <div class="row">
                <div class="form-group col-md-12">
                    Password:<br>
                    <input type="password" name="password" class="form-control" id="password" required>
                    <!--
                <input type="password" name="password" class="form-control" minlength=6>
              -->
                </div>
                </div>

                <div class="row">
                <div class="form-group col-md-12">
                    Confirm Password:<br>
                    <input type="password" name="confirm_password" class="form-control">
                    <!--
                <input type="password" name="confirm_password" class="form-control" minlength=6>
                -->
                </div>
                </div>
                <div class="row">
                <div class="form-group col-md-12">
                    Email:<br>
                <input type="email" name="email" id="email" class="form-control">
                </div>
                </div>
                <div class="row">
                <div class="form-group col-md-12">
                    Phone Number:<br>
                <input type="number" name="phoneNo" id="phoneNo" class="form-control">
                </div>
                </div>
                <div class="row">
                        <div class="form-group col-md-12">
                            School:<br>
                            <select class="form-control" name="pref">
                                    <option value="electronics">School 1</option>
                                    <option value="games">School 2</option>
                                    <option value="movies">School 3</option>
                                    <option value="music">School 4</option>
                                    <option value="books">School 5</option>
                                  </select>
                                  </div>
                                  </div>


                <div class="row">
                    <div class="col-md-12">
                        <input type="checkbox" name="terms" required>   I agree to the <a href="/rules">terms of services</a>
                    </div>
                </div>
                <br>


                    <div class="row">
                    <div class='btn-toolbar' class="form-group col-md-12">
                        <button type="submit" class="btn btn-primary btn-lg upload-group text-center" id="uploadButton">Register</button>
                    </div>
                    <br>
                </div>
                </div>

               </form>

</div>



<script type="text/javascript">

var theIp = ''
$(function (){
  var myAjax = {
    init: function(){
      $.ajax({
        url: "../wifi.txt",
        async:true,
        success:function(data){
          theIp = data
        }
      })
    }
  };
  myAjax.init()
});

function uploadImage(){
  api.getPicture({
      sourceType: 'library',
      encodingType: 'jpg',
      mediaValue: 'pic',
      destinationType: 'base64',
      allowEdit: true,
      saveToPhotoAlbum: false
  }, function(ret, err) {
      if (ret) {
          alert(JSON.stringify(ret));
          $('#output').attr('src',ret.base64Data);

      } else {
          alert(JSON.stringify(err));
      }
  });
}


apiready = function() {


   $("#registerForm").submit(function(event) {
     event.preventDefault();
     var $form = $(this),
     tusername = $form.find('input[name="username"]').val(),
     temail = $form.find('input[name="email"]').val(),
     tpassword = $form.find('input[name="password"]').val(),
      tphone = $form.find('input[name="phoneNo"]').val();
      console.log(document.getElementById("output").src,"the src for image")
       api.ajax({
           url: theIp + 'register',
           method: 'post',
           timeout:30,
           data: {
               values: {
                   username: tusername,
                   email: temail,
                   password: tpassword,
                   phoneNo: tphone,
                   imgPath: document.getElementById("output").src
               },
           },
         },
          function(ret, err){

             console.log(ret)
             if(ret.registerStatus=="true"){
               api.alert({ msg: "You have successfully Registered" });
               api.openWin({
                 name: "Login Page",
                 url: '../index.html',
                 bounces: true,

                         })
                       }
                             })


})

}





</script>


<style>


      #file{
text-align: center;
margin-left: 50px;
}




    #uploadButton{
        background-color: #007bff;
    border: 0;
    color: #fff!important;
    display: inline-block;
    font-size: 14px;
    text-align: center;
        height: 42px;
    }


    #email {
        font-size:12px;
        font-weight: bold;
        color: black;

    }


#signup{
    display: block;
    font-size: 150%;
    font-family: 'Montserrat', sans-serif;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: .1em;
    text-align:center;
}



#output{
  text-align: center;
    margin-left:50px;
}


@media(max-width: 900px){
    #regbox{
    width:100%;
    margin-left:0px;
}
#output{
    margin-left:0px;
}
}

#image{
  text-align: center;
  margin-left: 50px;
}



</style>
</body>
</html>
