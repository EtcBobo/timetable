<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width" />
    <meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
    <title>Profile Page</title>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />

</head>

<body class="wrap">
  <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
 -->

  <div class="container" >

    <section class="flex-1">
      <h2>Profile</h2>
<br>
<br>
<br>
<img src="../image/loading_more.gif" style="width:100px;height:100px;" id="profileImg">
<br>
<p>Name: Andy</p>
<p>School: <p style="font-style:bold">Chengdu Uni</p>
<br>
<p id="tusername"></p>



    </section>



</div>

</body>
<script type="text/javascript" src="../script/api.js"></script>

<script type="text/javascript">
document.getElementById("tusername").innerHTML = localStorage.getItem("username")

    apiready = function() {

      console.log(api);
      var moduleSMSSDK = api.require('smssdk');
      console.log(moduleSMSSDK)
      moduleSMSSDK.getTextCode({
        phoneNumber:15102844940,
        zone:'86'
      },function(ret,err){
        if (err !== null && err !== undefined && err !== '') {
       // 错误消息示例：{"msg":"Template not exist.","code":484}
        alert("Error:\n" + JSON.stringify(err));
      } else {
          // 正常消息示例：{"smart":false}
         alert("Success:\n" + JSON.stringify(ret));
      }
    });

      if(localStorage.getItem("isLoggedin") != "true"){
        api.openWin({
          name: "Login Page",
          url: '../index.html',
          bounces: true
        })
      }


      var theIp = ''
      $(function (){
        var myAjax = {
          init: function(){
            $.ajax({
              url: "../wifi.txt",
              async:false,
              success:function(data){
                theIp = data
              }
            })
          }
        };
        myAjax.init()
      });

    api.ajax({
        url: theIp + 'profile',
        method: 'post',
        timeout:30,
        data: {
            values: {
              username:localStorage.getItem("username")
        },
      },

    },function(ret, err){
        if (ret) {
            $('#profileImg').attr('src',ret.image);
        } else {
            alert( JSON.stringify( err ) );
        }
    });

    };

</script>

</html>
